<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <title>Historical Timeline V0.0.09</title>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/timelineWhole.css">
    <link rel="stylesheet" href="css/timelineHalf.css">
    <link rel="stylesheet" href="css/timelineThird.css">

  </head>

  <body>
    <div id = "Top">

      <select id="dropdownOne" class = "dropdown" form = "timelineSelector">
      </select>
      <select id="dropdownTwo" class = "dropdown" form = "timelineSelector">
      </select>
      <select id="dropdownThree" class = "dropdown" form = "timelineSelector">
      </select>
      <div id = "Buttons">
          <button type = "button" id = "submit" onclick = "changePage()"> Submit </button>
          <button type = "button" id = "reset" onclick = "resetPage()"> Reset </button>
      </div>

    </div>
    <div id = "timeline">
        <div class = "overlay"></div>
    </div>
    <div id = "footer">
      <a href = "/">Home</a>
      <a href = "/aboutUs.html">About us</a>
      <a href = "/contactUs.html">Contact Us</a>
      <a href = "/Donate.html">Donate</a>
    </div>



 
  <script type="text/javascript">
    var xhreq = new XMLHttpRequest();
    var url = "/timeline";
    xhreq.open("GET", url, true);
    xhreq.send(); 
    xhreq.onreadystatechange = function() {
        if (xhreq.readyState == 4 && xhreq.status == 200) {
            var myArr = JSON.parse(xhreq.responseText);
            makeDropdown(myArr);
        }
    };
    function makeDropdown(arr) {
      var i;
      var out = '';
      
      for(i = 0; i < arr.length; i++) {
            out += ' <option value = "' + arr[i].timelineName + '">' + arr[i].timelineName + '</option>';
        }
        document.getElementById("dropdownOne").innerHTML = out;
        var revisedOut = '<option value="None">None</option>' + out;
        document.getElementById("dropdownTwo").innerHTML = revisedOut;
        document.getElementById("dropdownThree").innerHTML = revisedOut;
    }
    </script>


    <script>
      function changePage(){
        var numberOfTimelines = 1;
        var one = document.getElementById("dropdownOne");
        one = one.options[one.selectedIndex].value;

        var two = document.getElementById("dropdownTwo");
        two = two.options[two.selectedIndex].value;
        if(two != "None" && two != one)
          numberOfTimelines++;

        var three = document.getElementById("dropdownThree");
        three = three.options[three.selectedIndex].value;
        if(three != "None" && three != two && three != one)
          numberOfTimelines++;

        var format;
        if(numberOfTimelines == 1)
          format = "whole";
        else if(numberOfTimelines == 2)
          format = "half";
        else if(numberOfTimelines == 3)
          format = "third";

        var color = getColor();
        requestTimeline(one, format, true, color);


        if(two != "None" && two != one){
          var newColor = getColor();
          while(color == newColor)
             newColor = getColor();
          color = newColor;
          requestTimeline(two, format, false, color);
        }
        if(three != "None" && three != two && three != one){
          var newColor = getColor();
          while(color == newColor)
             newColor = getColor();
          color = newColor;
          requestTimeline(three, format, false, color);
        }
      }

      function requestTimeline(ext, format, reset, color){
        var url = "timeline/" + ext;
        var xhr = new XMLHttpRequest();
        xhr.open("GET", url, false);
        xhr.send(null); 

        if (xhr.status == 200) {
            var myArr = JSON.parse(xhr.responseText);
            makeTimeline(myArr, format, reset, color);
        }
      }

      function makeTimeline(arr, format, reset, color) {
        var i;
        var out;

        out = '<div class = "overlay' + format + ' color' + color +'"><div class = "' + format + '">';

        //real
        out += '<div class= "event offset-first"> <h1> ' + arr[0].year + '</h1><h1 class = "name"> ' + arr[0].nameTitle + '</h1><img src = "' + arr[0].img + '""></img><div class = "Text">' + arr[0].description + '</div>  <a href = "' + arr[0].url + '">More Info </a> </div>' ;  
             for(i = 1; i < arr.length; i++) {
                  out += ' <div class= "event"> <h1> ' + arr[i].year + '</h1><h1 class = "name"> ' + arr[i].nameTitle + '</h1><img src = "' + arr[i].img + '""></img><div class = "Text">' + arr[i].description + '</div>  <a href = "' + arr[i].link + '">More Info </a> </div>';
              }
          out += '</div></div>';
          if(reset)
            document.getElementById("timeline").innerHTML = out;
          else{
            document.getElementById("timeline").innerHTML += out;
          }
      }

      function getColor(){
        var number = Math.floor((Math.random() * 6) + 1);
        var color;
        if(number == 1)
          color = "red";
        else if(number == 2)
          color = "orange";
        else if(number == 3)
          color = "yellow";
        else if(number == 4)
          color = "green";
        else if(number == 5)
          color = "blue";
        else if(number == 6)
          color = "purple";
        return color;
      }

      function resetPage(){
          document.getElementById("timeline").innerHTML = '<div class = "overlay"></div>';
      }
       
    </script>
  </body>
</html>
